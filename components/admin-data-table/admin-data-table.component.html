@if (!simpleTable) {
<div class="card shadow mb-4">
    <div class="card-body">

        <div class="row mb-3">
            <div class="d-flex align-items-center justify-content-between">
                <div class="flex-grow-1 d-flex align-items-center">
                    <!-- Search -->
                    @if (config.dataOptions?.search) {
                    <form [formGroup]="searchForm" class="d-flex align-items-center table-search mb-2 mb-sm-0"
                        (ngSubmit)="onSearch()">
                        <div class="input-group position-relative">
                            <input type="text" class="form-control bg-light"
                                [placeholder]="config.dataOptions?.search?.placeholder || 'Pretraga...'"
                                aria-label="Search" formControlName="keyword" />

                            @if (searchForm.get('keyword')?.value) {
                            <button type="button" class="clear-btn" (click)="clearSearch()" aria-label="Clear search">
                                <i class="fa fa-times"></i>
                            </button>
                            }

                            <div class="input-group-append">
                                <button class="btn btn-primary" type="submit">
                                    <i class="fa fa-search fa-xs"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                    }

                    <!-- Action buttons -->
                    <div class="ms-auto d-flex align-items-center gap-2">
                        @for (button of config.buttons; track $index) {
                        <button (click)="handleBtnClick(button.actionName)" class="btn" [class]="button.class">
                            @if (button.icon) {
                            <i [class]="button.icon" class="fa text-white-50 me-1" style="font-size: 14px;"></i>
                            }
                            <span class="text">{{ button.label }}</span>
                        </button>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Table -->
        <div class="table-responsive">
            <table class="table table-bordered table-hover" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        @for (col of config.columns; track $index) {
                        <th [ngStyle]="getHeaderStyle(col)" [class]="col.className">
                            {{ col.header }}

                            @if (col.sortable) {
                            <div class="sort-icons">
                                <button class="btn up" [class.active]="isSortActive(col.value, 'ASC')"
                                    (click)="onSort(col.value, 'ASC')">
                                    <i class="fa fa-caret-up" aria-hidden="true"></i>
                                </button>
                                <button class="btn down" [class.active]="isSortActive(col.value, 'DESC')"
                                    (click)="onSort(col.value, 'ASC')">
                                    <i class="fa fa-caret-down" aria-hidden="true"></i>
                                </button>
                            </div>
                            }
                        </th>
                        }
                    </tr>
                </thead>

                <tbody>
                    @for (row of rows; track $index) {
                    <tr>
                        @for (column of config.columns; track $index) {
                        <td [class]="'align-middle ' + (column.className || '')" [ngStyle]="getHeaderStyle(column)">
                            @if (column.link) {
                            <a [routerLink]="column.link(row)">
                                {{ getColumnText(row, column) }}
                            </a>
                            } @else if (column.pipe && column.value) {
                            {{ applyPipe(getText(row, column.value), column.pipe) }}
                            } @else if (column.badge && column.value) {
                            <span class="badge"
                                [class]="'badge-' + (column.badge[(getText(row, column.value) ?? '').toString()] || 'light')">
                                {{ getText(row, column.value) }}
                            </span>
                            } @else {
                            @if (column.value !== 'actions') {
                            <span>{{ getColumnText(row, column) }}</span>
                            } @else {
                            @for (action of column.actions; track $index) {
                            <button class="btn btn-action" [class]="'btn btn-action ' + (action.color || 'secondary')"
                                (click)="handleActionClick(action, row)" [tooltip]="action.label">
                                @if (action.icon) {
                                <i [class]="action.icon"></i>
                                }
                            </button>
                            }
                            }
                            }
                        </td>
                        }
                    </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- Footer (pagination) -->
        @if (pagination && rows) {
        <div class="row align-items-center table-footer mt-3">
            <div class="col">
                <span>
                    Prikazano
                    {{ ((currentPage - 1) * pageSize) + (totalElements > 0 ? 1 : 0) }}
                    - {{ currentPage * pageSize < totalElements ? currentPage * pageSize : totalElements }} od {{
                        totalElements }} {{ getItemLabel(totalElements) }} </span>
            </div>

            <div class="col">
                @if (pages.length > 1) {
                <nav class="pull-right">
                    <ul class="pagination mb-0">
                        <li class="page-item" [class.disabled]="currentPage <= 1">
                            <button class="page-link" (click)="onPageChange(currentPage - 1)" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </button>
                        </li>

                        @for (i of pages; track $index) {
                        <li class="page-item" [class.active]="+i === currentPage" [class.disabled]="i === '...'">
                            <button class="page-link" (click)="onPageChange(+i)">{{ i }}</button>
                        </li>
                        }

                        <li class="page-item" [class.disabled]="currentPage >= pages.length">
                            <button class="page-link" (click)="onPageChange(currentPage + 1)" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </button>
                        </li>
                    </ul>
                </nav>
                }
            </div>
        </div>
        }

        <!-- Footer (non-paginated) -->
        @if (!simpleTable && !pagination && data) {
        <div class="row align-items-center mt-3">
            <div class="col">
                @if (rows.length === items.length) {
                <span>
                    Prikazano {{ rows.length }} {{ getItemLabel(rows.length) }}
                </span>
                } @else {
                <span>
                    Prikazano {{ rows.length }} od {{ items.length }} {{ getItemLabel(items.length) }} (filtrirano)
                </span>
                }
            </div>
        </div>
        }

        <div class="row">
            <div class="col-12">
                <ng-content select="[after-table-content]"></ng-content>
            </div>
        </div>

    </div>
</div>
} @else {
<!-- Simple table mode -->
<div>
    <div>

        <div class="table-responsive">
            <table class="table table-bordered table-hover" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        @for (col of config.columns; track $index) {
                        <th [ngStyle]="getHeaderStyle(col)" [class]="col.className">
                            {{ col.header }}
                            @if (col.sortable) {
                            <div class="sort-icons">
                                <button class="btn up" [class.active]="isSortActive(col.value, 'ASC')"
                                    (click)="onSort(col.value, 'ASC')">
                                    <i class="fa fa-caret-up" aria-hidden="true"></i>
                                </button>
                                <button class="btn down" [class.active]="isSortActive(col.value, 'DESC')"
                                    (click)="onSort(col.value, 'ASC')">
                                    <i class="fa fa-caret-down" aria-hidden="true"></i>
                                </button>
                            </div>
                            }
                        </th>
                        }
                    </tr>
                </thead>

                <tbody>
                    @for (row of rows; track $index) {
                    <tr>
                        @for (column of config.columns; track $index) {
                        <td [class]="'align-middle ' + (column.className || '')" [ngStyle]="getHeaderStyle(column)">
                            @if (column.link) {
                            <a [routerLink]="column.link(row)">{{ getColumnText(row, column) }}</a>
                            } @else if (column.pipe && column.value) {
                            {{ applyPipe(getText(row, column.value), column.pipe) }}
                            } @else if (column.badge && column.value) {
                            <span class="badge"
                                [class]="'badge-' + (column.badge[(getText(row, column.value) ?? '').toString()] || 'light')">
                                {{ getText(row, column.value) }}
                            </span>
                            } @else {
                            @if (column.value !== 'actions') {
                            <span>{{ getColumnText(row, column) }}</span>
                            } @else {
                            @for (action of column.actions; track $index) {
                            <button class="btn btn-action" [class]="'btn btn-action ' + (action.color || 'secondary')"
                                (click)="handleActionClick(action, row)" [tooltip]="action.label">
                                @if (action.icon) { <i [class]="action.icon"></i> }
                            </button>
                            }
                            }
                            }
                        </td>
                        }
                    </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="row">
            <div class="col-12">
                <ng-content select="[after-table-content]"></ng-content>
            </div>
        </div>

    </div>
</div>
}